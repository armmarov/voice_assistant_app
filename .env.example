# ─── Voice Assistant — environment configuration ──────────────────────────────
#
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# .env is loaded automatically at startup (python-dotenv).
# Regular environment variables always override .env values.
# .env is git-ignored — never commit it.
# ──────────────────────────────────────────────────────────────────────────────


# ─── Wake Word ──────────────────────────────────────────────────────────────
# Engine: "openwakeword" (free, slower) or "porcupine" (fast, requires access key)
WAKE_WORD_ENGINE=openwakeword

# --- OpenWakeWord settings ---
# Built-in models (no download needed): hey_jarvis, alexa, hey_mycroft, hey_rhasspy
WAKE_WORD_MODEL=hey_jarvis
# Path to custom .onnx/.tflite wake word model file (leave empty for built-in).
WAKE_WORD_MODEL_PATH=
# Detection threshold (0.0 – 1.0). Higher = less sensitive, fewer false positives.
WAKE_WORD_THRESHOLD=0.5

# --- Porcupine settings ---
# Get your access key from https://console.picovoice.ai/
PORCUPINE_ACCESS_KEY=
# Built-in keywords: porcupine, bumblebee, alexa, jarvis, computer, hey google, etc.
PORCUPINE_KEYWORD=jarvis
# Path to custom .ppn keyword file (leave empty for built-in keyword).
PORCUPINE_KEYWORD_PATH=
# Sensitivity (0.0 – 1.0). Higher = more sensitive.
PORCUPINE_SENSITIVITY=0.5

# --- Common ---
# Milliseconds to wait for speech after wake word before returning to IDLE.
WAKE_LISTEN_TIMEOUT_MS=10000
# Conversation timeout — after a reply, how long to wait for the next question
# before returning to IDLE (wake word required again). Default: 30000 (30s).
CONVERSATION_TIMEOUT_MS=30000
# Go to IDLE after N consecutive ASR noise results in conversation mode.
MAX_NOISE_STREAK=3
# Phrase spoken after wake word is detected. Leave empty for beep only.
WAKE_WORD_ACK_PHRASE=Yes sir


# ─── ASR Service ──────────────────────────────────────────────────────────────
ASR_BASE_URL=http://3.114.138.123:8005
# ASR_TIMEOUT=30


# ─── TTS Service ──────────────────────────────────────────────────────────────
TTS_BASE_URL=http://3.114.138.123:8006

# Voice selection: default | liudao | filrty | zhiyu
TTS_VOICE=default
# TTS_TIMEOUT=60
# Volume gain applied before playback (1.0 = no change, 3.0 = 3x louder).
# Increase if TTS output is too quiet relative to other audio.
TTS_VOLUME_GAIN=1.0


# ─── LLM Service (OpenAI-compatible) ──────────────────────────────────────────
LLM_BASE_URL=http://localhost:11434/v1
LLM_API_KEY=nokey
LLM_MODEL=llama3
# LLM_MAX_TOKENS=150
# LLM_SYSTEM_PROMPT=You are a helpful voice assistant. Your responses will be spoken aloud via text-to-speech. Keep answers to 1-3 short sentences. No bullet points, no lists, no markdown, no emojis.
# LLM_TIMEOUT=60


# ─── Audio Devices ────────────────────────────────────────────────────────────
# Run this to list device indices:
#   python3 -c "import pyaudio; pa=pyaudio.PyAudio(); [print(i, pa.get_device_info_by_index(i)['name']) for i in range(pa.get_device_count())]"
# Set to -1 to use the system default.
MIC_DEVICE_INDEX=-1
SPK_DEVICE_INDEX=-1


# ─── Echo Cancellation ────────────────────────────────────────────────────────
# Mute mic in software during TTS playback (prevents self-triggering).
MIC_MUTE_DURING_PLAYBACK=true


# ─── VAD Tuning ───────────────────────────────────────────────────────────────
# VAD_AGGRESSIVENESS=3      # 0 (least) – 3 (most aggressive noise filtering)
# VAD_SILENCE_MS=1200       # Silence duration (ms) that ends an utterance
# VAD_MIN_SPEECH_MS=2000    # Minimum speech length (ms); shorter clips are ignored


# ─── Logging ──────────────────────────────────────────────────────────────────
LOG_FILE=/var/log/voice_assistant.log
LOG_LEVEL=INFO
